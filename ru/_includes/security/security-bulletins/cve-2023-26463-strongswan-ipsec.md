## 13.04.2023 — CVE-2023-26463 — StrongSwan IPsec — Incorrectly Accepted Untrusted Public Key With Incorrect Refcount {#CVE-2023-26463}

CVE ID: CVE-2023-26463

Ссылка на CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-26463>

### Исходный отчет {#original-report-CVE-2023-26463}

<https://www.strongswan.org/blog/2023/03/02/strongswan-vulnerability-(cve-2023-26463).html>

### Краткое описание {#brief-description-CVE-2023-26463}

Реализация TLS в `libtls` неверно идентифицирует открытый ключ из сертификата однорангового узла как доверенный, даже если сертификат не проходит проверку. Однако у открытого ключа также возникает ошибка при подсчете количества ссылок, что приводит к разыменованию указателя с истекшим сроком действия. Обычно это приводит к сбою сегментации и отказу сервиса, но при этом возможно раскрытие информации или выполнение кода.

Злоумышленник может вызвать этот сбой, отправив самоподписанный (или по другим причинам ненадежный) сертификат на сервер, который аутентифицирует клиентов с помощью метода EAP на основе TLS, такого как EAP-TLS. Клиенты могут быть также уязвимы для злоумышленников, которые отправляют им запрос на такой метод EAP с ненадежным сертификатом сервера. Затронуты версии strongSwan 5.9.8 и 5.9.9.

### Затронутые технологии {#technologies-affected-CVE-2023-26463}

StrongSwan IPsec

### Уязвимые продукты и версии {#vulnerable-products-and-versions-CVE-2023-26463}

StrongSwan IPsec до версии 5.9.10

### Вендор {#vendor-CVE-2023-26463}

StrongSwan IPsec

### Вектор атаки и уровень опасности согласно CVSS v.3.0 {#attack-vector-and-severity-level-CVE-2023-26463}

Not installed on 29.03.2023.

### Рекомендации по обнаружению уязвимости и дополнительные материалы {#recommendations-for-vulnerability-detection-CVE-2023-26463}

* <https://www.strongswan.org/blog/2023/03/02/strongswan-vulnerability-(cve-2023-26463).html>
* <https://www.opennet.ru/opennews/art.shtml?num=58736>

Серверы, которые не загружают плагины, реализующие методы EAP на основе TLS (EAP-TLS, EAP-TTLS, EAP-PEAP, EAP-TNC), не подвержены этой уязвимости. Если эти плагины загружаются, они не должны использоваться в качестве способа удаленной аутентификации. Также не следует использовать плагин `eap-dynamic`, поскольку он позволяет клиентам выбирать предпочтительный метод EAP. Серверы, которые используют методы на основе TLS через плагин `eap-radius` только в качестве способа удаленной аутентификации, также не подвержены этой уязвимости.

### Безопасная версия уязвимого продукта или патч {#safe-version-CVE-2023-26463}

StrongSwan IPsec начиная с версии 5.9.10

### Влияние на сервисы {{ yandex-cloud }} {#impact-on-yandex-cloud-services-CVE-2023-26463}

[Образ StrongSwan IPsec](/marketplace/products/yc/ipsec-instance-ubuntu) в {{ marketplace-full-name }} не подвержен данной уязвимости согласно <https://ubuntu.com/security/CVE-2023-26463>. Если вы используете собственный образ на ВМ, который подвержен уязвимости, то рекомендуется обновить его самостоятельно.
